filebeat.inputs:
  - type: container
    stream: stdout
    paths:
      - "/var/lib/docker/containers/*/*.log"
    json.keys_under_root: true
    json.add_error_key: true
    json.overwrite_keys: true
    json.expand_keys: true

filebeat.autodiscover:
  providers:
    - type: docker
      hints.enabled: true

processors:
  - add_docker_metadata: ~
  - add_host_metadata: ~

output.elasticsearch:
  hosts: ["elasticsearch:9200"]
  indices:
    - index: "elastic-%{+yyyy.MM.dd}"
      when.or:
        - equals:
            container.name: filebeat
        - equals:
            container.name: elasticsearch
        - equals:
            container.name: kibana
    - index: "apps-%{+yyyy.MM.dd}"
      when.or:
        - equals:
            container.name: grpc-boilerplate
